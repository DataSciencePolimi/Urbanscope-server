{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;AAIb,IAAI,EAAE,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC;AACzB,IAAI,GAAG,GAAG,OAAO,CAAE,KAAK,CAAE,CAAC;AAC3B,IAAI,MAAM,GAAG,OAAO,CAAE,YAAY,CAAE,CAAC;AACrC,IAAI,IAAI,GAAG,OAAO,CAAE,UAAU,CAAE,CAAC;AACjC,IAAI,MAAM,GAAG,OAAO,CAAE,QAAQ,CAAE,CAAC;;;AAGjC,IAAI,YAAY,GAAG,OAAO,CAAE,uBAAuB,CAAE,CAAC;AACtD,IAAI,eAAe,GAAG,OAAO,CAAE,wBAAwB,CAAE,CAAC;AAC1D,IAAI,UAAU,GAAG,OAAO,CAAE,mBAAmB,CAAE,CAAC;AAChD,IAAI,cAAc,GAAG,OAAO,CAAE,uBAAuB,CAAE,CAAC;AACxD,IAAI,cAAc,GAAG,OAAO,CAAE,uBAAuB,CAAE,CAAC;AACxD,IAAI,UAAU,GAAG,OAAO,CAAE,mBAAmB,CAAE,CAAC;AAChD,IAAI,SAAS,GAAG,OAAO,CAAE,UAAU,CAAE,CAAC,IAAI,CAAC;AAC3C,IAAI,UAAU,GAAG,OAAO,CAAE,UAAU,CAAE,CAAC,KAAK,CAAC;;;;;AAO7C,IAAI,GAAG,GAAG,GAAG,EAAE,CAAC;AAChB,IAAI,GAAG,GAAG,MAAM,CAAC,YAAY,CAAE;AAC7B,MAAI,EAAE,QAAQ;AACd,OAAK,EAAE,OAAO,EACf,CAAE,CAAC;;;;;;;AAUJ,GAAG,CAAC,IAAI,GAAG,mBAAmB,CAAC;AAC/B,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC;;;AAIjB,EAAE,0BAAE;MAQE,MAAM,EAaN,IAAI;;;;;AAnBR,iBAAS,EAAE,CAAC;;;AAGZ,WAAG,CAAC,GAAG,CAAE,IAAI,EAAE,CAAE,CAAC;;AAGd,cAAM,GAAG,IAAI,MAAM,CAAE,GAAG,CAAE;;AAE9B,cAAM,CAAC,GAAG,CAAE,mBAAmB,EAAE,eAAe,CAAE,CAAC;AACnD,cAAM,CAAC,GAAG,CAAE,cAAc,EAAE,UAAU,CAAE,CAAC;AACzC,cAAM,CAAC,GAAG,CAAE,kBAAkB,EAAE,cAAc,CAAE,CAAC;AACjD,cAAM,CAAC,GAAG,CAAE,kBAAkB,EAAE,cAAc,CAAE,CAAC;AACjD,cAAM,CAAC,GAAG,CAAE,cAAc,EAAE,UAAU,CAAE,CAAC;;;AAGzC,WAAG,CAAC,GAAG,CAAE,MAAM,CAAC,MAAM,EAAE,CAAE,CAAC;AAC3B,WAAG,CAAC,GAAG,CAAE,MAAM,CAAC,cAAc,EAAE,CAAE,CAAC;;AAG/B,YAAI,GAAG,YAAY,CAAC,IAAI;;AAC5B,WAAG,CAAC,KAAK,CAAE,wBAAwB,EAAE,IAAI,CAAE,CAAC;AAC5C,WAAG,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;;;;;;;CACpB,EAAE,SACG,CAAE,UAAU,GAAG,EAAG;AACtB,KAAG,CAAC,KAAK,CAAE,GAAG,EAAE,aAAa,CAAE,CAAC;AAChC,YAAU,EAAE,CAAC;AACb,SAAO,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC;CACnB,CAAE,CAAC","file":"index.js","sourcesContent":["'use strict';\n// Load system modules\n\n// Load modules\nlet co = require( 'co' );\nlet koa = require( 'koa' );\nlet Router = require( 'koa-router' );\nlet cors = require( 'koa-cors' );\nlet bunyan = require( 'bunyan' );\n\n// Load my modules\nlet serverConfig = require( '../config/server.json' );\nlet districtAnomaly = require( './api/district-anomaly' );\nlet topAnomaly = require( './api/top-anomaly' );\nlet districtTweets = require( './api/district-tweets' );\nlet timelineTweets = require( './api/timeline-tweets' );\nlet textTweets = require( './api/text-tweets' );\nlet openMongo = require( './model/' ).open;\nlet closeMongo = require( './model/' ).close;\n\n\n// Constant declaration\n\n\n// Module variables declaration\nlet app = koa();\nlet log = bunyan.createLogger( {\n  name: 'server',\n  level: 'trace',\n} );\n\n\n// Module functions declaration\n\n// Module class declaration\n\n\n\n// Module initialization (at first load)\napp.name = 'UrbanScope server';\napp.proxy = true;\n\n\n// Entry point\nco( function*() {\n  // Setup mongo\n  openMongo();\n\n  // Middlewares\n  app.use( cors() );\n\n  // Add endpoints\n  let router = new Router( app );\n\n  router.get( '/anomaly/district', districtAnomaly );\n  router.get( '/anomaly/top', topAnomaly );\n  router.get( '/tweets/district', districtTweets );\n  router.get( '/tweets/timeline', timelineTweets );\n  router.get( '/tweets/text', textTweets );\n\n  // Add the router to the Koa Application\n  app.use( router.routes() );\n  app.use( router.allowedMethods() );\n\n  // Start server\n  let port = serverConfig.port;\n  log.debug( 'Start server @ port %d', port );\n  app.listen( port );\n} )\n.catch( function( err ) {\n  log.fatal( err, 'NUOOOOOOOOO' );\n  closeMongo();\n  process.exit( 1 );\n} );\n\n//  50 6F 77 65 72 65 64  62 79  56 6F 6C 6F 78"],"sourceRoot":"/source/"}