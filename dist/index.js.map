{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;kBAIE,IAAI;;;;mBACH,KAAK;;;;yBACD,YAAY;;;;uBACd,UAAU;;;;sBACT,QAAQ;;;;;;qBAG4B,UAAU;;gCACxC,uBAAuB;;;;kCACpB,wBAAwB;;;;6BAC7B,mBAAmB;;;;iCACf,uBAAuB;;;;iCACvB,uBAAuB;;;;6BAC3B,mBAAmB;;;;;;;AAO1C,IAAI,GAAG,GAAG,uBAAK,CAAC;AAChB,IAAI,GAAG,GAAG,oBAAO,YAAY,CAAE;AAC7B,MAAI,EAAE,QAAQ;AACd,OAAK,EAAE,OAAO,EACf,CAAE,CAAC;;;;;;;AAUJ,GAAG,CAAC,IAAI,GAAG,mBAAmB,CAAC;AAC/B,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC;;;AAIjB,8CAAI;MAQE,MAAM,EAaJ,IAAI;;;;;AAnBV,mBAlCO,IAAI,GAkCA,CAAC;;;AAGZ,WAAG,CAAC,GAAG,CAAE,2BAAM,CAAE,CAAC;;AAGd,cAAM,GAAG,2BAAY,GAAG,CAAE;;AAE9B,cAAM,CAAC,GAAG,CAAE,mBAAmB,kCAAmB,CAAC;AACnD,cAAM,CAAC,GAAG,CAAE,cAAc,6BAAc,CAAC;AACzC,cAAM,CAAC,GAAG,CAAE,kBAAkB,iCAAkB,CAAC;AACjD,cAAM,CAAC,GAAG,CAAE,kBAAkB,iCAAkB,CAAC;AACjD,cAAM,CAAC,GAAG,CAAE,cAAc,6BAAc,CAAC;;;AAGzC,WAAG,CAAC,GAAG,CAAE,MAAM,CAAC,MAAM,EAAE,CAAE,CAAC;AAC3B,WAAG,CAAC,GAAG,CAAE,MAAM,CAAC,cAAc,EAAE,CAAE,CAAC;;AAG7B,YAAI,iCAAJ,IAAI;;AACV,WAAG,CAAC,KAAK,CAAE,wBAAwB,EAAE,IAAI,CAAE,CAAC;AAC5C,WAAG,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;;;;;;;CACpB,EAAE,SACG,CAAE,UAAA,GAAG,EAAI;AACb,KAAG,CAAC,KAAK,CAAE,GAAG,EAAE,aAAa,CAAE,CAAC;AAChC,aA3D0B,KAAK,GA2DnB,CAAC;AACb,SAAO,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC;CACnB,CAAE,CAAC","file":"index.js","sourcesContent":["'use strict';\n// Load system modules\n\n// Load modules\nimport co from 'co';\nimport koa from 'koa';\nimport Router  from 'koa-router';\nimport cors  from 'koa-cors';\nimport bunyan from 'bunyan';\n\n// Load my modules\nimport { open as openMongo, close as closeMongo } from './model/';\nimport serverConfig from '../config/server.json';\nimport districtAnomaly from './api/district-anomaly';\nimport topAnomaly from './api/top-anomaly';\nimport districtTweets from './api/district-tweets';\nimport timelineTweets from './api/timeline-tweets';\nimport textTweets from './api/text-tweets';\n\n\n// Constant declaration\n\n\n// Module variables declaration\nlet app = koa();\nlet log = bunyan.createLogger( {\n  name: 'server',\n  level: 'trace',\n} );\n\n\n// Module functions declaration\n\n// Module class declaration\n\n\n\n// Module initialization (at first load)\napp.name = 'UrbanScope server';\napp.proxy = true;\n\n\n// Entry point\nco( function*() {\n  // Setup mongo\n  openMongo();\n\n  // Middlewares\n  app.use( cors() );\n\n  // Add endpoints\n  let router = new Router( app );\n\n  router.get( '/anomaly/district', districtAnomaly );\n  router.get( '/anomaly/top', topAnomaly );\n  router.get( '/tweets/district', districtTweets );\n  router.get( '/tweets/timeline', timelineTweets );\n  router.get( '/tweets/text', textTweets );\n\n  // Add the router to the Koa Application\n  app.use( router.routes() );\n  app.use( router.allowedMethods() );\n\n  // Start server\n  let { port } = serverConfig;\n  log.debug( 'Start server @ port %d', port );\n  app.listen( port );\n} )\n.catch( err => {\n  log.fatal( err, 'NUOOOOOOOOO' );\n  closeMongo();\n  process.exit( 1 );\n} );\n\n//  50 6F 77 65 72 65 64  62 79  56 6F 6C 6F 78"],"sourceRoot":"/source/"}